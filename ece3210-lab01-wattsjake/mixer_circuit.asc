Version 4
SHEET 1 2096 824
WIRE 160 160 160 144
WIRE 160 160 32 160
WIRE 864 176 784 176
WIRE 944 176 864 176
WIRE 32 192 32 160
WIRE 160 192 160 160
WIRE 864 192 864 176
WIRE 944 208 944 176
WIRE 1008 208 944 208
WIRE 1344 240 1200 240
WIRE 1536 240 1424 240
WIRE 1664 272 1584 272
WIRE 1792 272 1744 272
WIRE 864 352 784 352
WIRE 944 352 864 352
WIRE 944 368 944 352
WIRE 1008 368 944 368
WIRE 1344 400 1200 400
WIRE 1536 400 1536 240
WIRE 1536 400 1424 400
WIRE 1584 400 1584 272
WIRE 1584 400 1536 400
WIRE 1632 400 1584 400
WIRE 1792 416 1792 272
WIRE 1792 416 1696 416
WIRE 1872 416 1792 416
WIRE 1632 432 1584 432
WIRE 1584 464 1584 432
WIRE 864 528 784 528
WIRE 1008 528 864 528
WIRE 1344 560 1200 560
WIRE 1536 560 1536 400
WIRE 1536 560 1424 560
WIRE 1584 576 1584 544
FLAG 32 192 0
FLAG 160 64 VCC
FLAG 160 272 VEE
FLAG 1008 272 VEE
FLAG 1008 240 VCC
FLAG 1008 432 VEE
FLAG 1008 400 VCC
FLAG 1008 592 VEE
FLAG 1008 560 VCC
FLAG 1664 448 VEE
FLAG 1664 384 VCC
FLAG 1584 576 0
FLAG 0 736 0
FLAG 336 736 0
FLAG 144 736 0
FLAG 0 656 Vmic
FLAG 784 176 Vmic
FLAG 336 656 Vint
FLAG 784 528 Vint
FLAG 144 656 Vline
FLAG 784 352 Vline
FLAG 864 272 0
FLAG 864 432 0
FLAG 864 608 0
FLAG 1872 416 Vout
SYMBOL voltage 160 48 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 15
SYMBOL voltage 160 176 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value 15
SYMBOL OpAmps\\opamp2 1664 352 R0
SYMATTR InstName U1
SYMATTR Value LM358
SYMBOL res 1440 224 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 10k
SYMBOL res 1440 384 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R2
SYMATTR Value 10k
SYMBOL res 1440 544 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value 10k
SYMBOL res 1760 256 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R4
SYMATTR Value 23.5k
SYMBOL voltage 0 640 R0
WINDOW 3 -84 137 Left 2
WINDOW 123 -84 165 Left 2
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value SINE(0 1 1k)
SYMATTR Value2 AC 1
SYMBOL voltage 336 640 R0
WINDOW 3 -82 139 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V4
SYMATTR Value SINE(0 1 3k)
SYMBOL voltage 144 640 R0
WINDOW 3 -61 137 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V5
SYMATTR Value SINE(0 1 2k)
SYMBOL unity_gain_op_amp 1104 240 R0
SYMATTR InstName mic
SYMBOL unity_gain_op_amp 1104 400 R0
SYMATTR InstName line
SYMBOL unity_gain_op_amp 1104 560 R0
SYMATTR InstName int
SYMBOL res 848 512 R0
SYMATTR InstName R5
SYMATTR Value 10k
SYMBOL res 848 336 R0
SYMATTR InstName R6
SYMATTR Value 10k
SYMBOL res 848 176 R0
SYMATTR InstName R7
SYMATTR Value 10k
SYMBOL res 1568 448 R0
SYMATTR InstName R11
SYMATTR Value 2.5k
TEXT 48 488 Left 2 !.tran 2m
TEXT 48 464 Left 2 !;.ac dec 10 10 10meg
TEXT 992 136 Left 2 ;Unity Gain Op Amps
TEXT 984 32 Left 2 !.lib "C:\\Users\\watts\\Documents\\LTspiceXVII\\microelectronics_2\\lib\\LM358 SPICE MODEL.lib"
TEXT 328 -48 Left 2 !;.step param mic 20k 21k 1k
TEXT 392 -136 Left 2 !.param line 13k
TEXT 392 -80 Left 2 !.param int 13k
TEXT 1016 -440 Left 2 !.meas tran Vmic_max max V(Vmic)
TEXT 1016 -416 Left 2 !.meas tran Irmic_max max I(R7)
TEXT 1016 -392 Left 2 !.meas tran Rin param Vmic_max/Irmic_max
TEXT 392 -200 Left 2 !.param mic 13k
TEXT 1008 -312 Left 2 !.meas tran Vline_max MAX V(Vline)\n.meas tran Irline_max MAX I(R6)\n.meas tran Rin_line param Vline_max/Irline_max
TEXT 1008 -208 Left 2 !.meas tran Vint_max MAX V(Vint)\n.meas tran Irint_max MAX I(R5)\n.meas tran Rin_int param Vint_max/Irint_max
TEXT 1016 -224 Left 2 ;Rin of INT
TEXT 1016 -336 Left 2 ;Rin LINE
TEXT 1024 -456 Left 2 ;Rin MIC
TEXT 1016 -80 Left 2 !.four 1k v(vout)
TEXT 328 -240 Left 2 ;Resistance of MIC, LINE, INT
TEXT 1016 -104 Left 2 ;THD
TEXT 248 -328 Left 2 !.meas AC tmp max mag(V(vout)); find the peak response
TEXT 248 -304 Left 2 !.meas AC BW when mag(v(vout))=tmp/sqrt(2)
TEXT 248 -360 Left 2 ;Bandwidth
